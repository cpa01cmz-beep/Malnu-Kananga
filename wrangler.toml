name = "malnu-api"
main = "worker.js"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# Environment variables untuk production
[env.production.vars]
# API_KEY akan di-set melalui Cloudflare dashboard atau CLI

# Bindings untuk Cloudflare services
[env.production]
# AI binding untuk Cloudflare AI models
ai = { binding = "AI" }
# Vectorize index untuk RAG functionality
[[env.production.vectorize]]
binding = "VECTORIZE"
index_name = "malnu-kananga-docs"
# D1 Database untuk authentication
[[env.production.d1_databases]]
binding = "DB"
database_name = "malnu-kananga-auth"
database_id = "REPLACE_WITH_ACTUAL_PRODUCTION_DATABASE_ID"

# Development environment
[env.preview.vars]
# API_KEY untuk development

[env.preview]
ai = { binding = "AI" }
[[env.preview.vectorize]]
binding = "VECTORIZE"
index_name = "malnu-kananga-docs-preview"
[[env.preview.d1_databases]]
binding = "DB"
database_name = "malnu-kananga-auth-preview"
database_id = "REPLACE_WITH_ACTUAL_PREVIEW_DATABASE_ID"

# Build configuration
[build]
command = "npm run build"

# Deployment configuration
[build.upload]
format = "service-worker"